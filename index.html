<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>GitHub PagesでのGeoJSON表示</title>
    <!-- MapLibre GL JS のCSSとJSを読み込み -->
    <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
    <style>
        /* 地図のサイズを指定 */
        body, html { margin: 0; padding: 0; height: 100%; }
        #map { width: 100%; height: 100vh; }
    </style>
</head>
<body>
    <!-- 地図を表示するためのコンテナ -->
    <div id="map"></div>

    <script>
        // MapLibre GL JS 地図の初期化
        const map = new maplibregl.Map({
            container: 'map',  // 地図を表示する要素のID
            style: 'https://tile.openstreetmap.jp/styles/osm-bright-ja/style.json',  // OSMのスタイル
            center: [139.6917, 35.6895],  // 東京の中心座標
            zoom: 10  // 初期ズームレベル
        });

        // GeoJSONファイルのリスト (URL、色、タイプを指定)
        const geoJsonFiles = [
            { url: './東京都（本島のみ）_行政区域_4326v2.geojson', color: '#000000', type: 'polygon' },
            { url: './東京駅_集客施設_4326.geojson', color: '#000000', type: 'point' },
            { url: './東京都_路線_R5_4326v3.geojson', color: '#ffffff', type: 'line',lineWidth:4,dashPattern:[2,4],underLineColor:'#000000',underLineWidth:6 }
            
        ];

        // 地図の読み込みが完了したらGeoJSONデータを追加
        map.on('load', () => {
    geoJsonFiles.forEach((file, index) => {
        fetch(file.url)
            .then(response => {
                if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);
                return response.json();
            })
           .then(data => {
                const sourceId = `data-source-${index}`;
                map.addSource(sourceId, {
                    type: 'geojson',
                    data: data
                });

                if (file.type === 'polygon') {
                    // ポリゴンレイヤー
                    map.addLayer({
                        id: `polygon-layer-${index}`,
                        type: 'fill',
                        source: sourceId,
                        paint: {
                            'fill-color': 'rgba(0, 0, 0, 0)',
                            'fill-outline-color': file.color
                        }
                    });
                } else if (file.type === 'point') {
                    // ポイントレイヤー
                    map.addLayer({
                        id: `point-layer-${index}`,
                        type: 'circle',
                        source: sourceId,
                        paint: {
                            'circle-radius': 6,
                            'circle-color': file.color,
                            'circle-stroke-width': 3,
                            'circle-stroke-color': '#ffffff'
                        }
                    });
             } else if (file.type === 'line') {
                            // 下の黒線レイヤー（太めの黒線）
                            map.addLayer({
                                id: `line-underlayer-${index}`,
                                type: 'line',
                                source: sourceId,
                                paint: {
                                    'line-color': file.underLineColor || '#000000', // 黒線
                                    'line-width': file.underLineWidth || 6, // 破線より太めの幅
                                    'line-opacity': 0.8
                                },
                                layout: {
                                    'line-cap': 'round',
                                    'line-join': 'round'
                                }
                            });

                            // 上の破線レイヤー（鉄道風の破線）
                            map.addLayer({
                                id: `line-layer-${index}`,
                                type: 'line',
                                source: sourceId,
                                paint: {
                                    'line-color': file.color || '#ff0000',    // 破線の色
                                    'line-width': file.lineWidth || 3,         // 破線の太さ
                                    'line-dasharray': file.dashPattern || [2, 4], // ダッシュパターン
                                    'line-opacity': 0.8
                                },
                                layout: {
                                    'line-cap': 'round',
                                    'line-join': 'round'
                                }
                            });
                        }
                    })
                    .catch(error => console.error(`GeoJSONファイルの読み込みに失敗しました: ${file.url}`, error));
            });
        });    </script>
</body>
</html>
